## 1. 项目初始化与构建

- [ ] 1.1 创建 Android 应用工程与基础目录结构（Gradle/Kotlin）
- [ ] 1.2 配置最低/目标 SDK、启用所需特性（如 Compose 方案则开启 Compose）
- [ ] 1.3 在 `AndroidManifest.xml` 声明悬浮窗相关能力（不添加 `INTERNET` 权限）
- [ ] 1.4 添加基础页面：用于开启/关闭悬浮面板与进入权限引导

## 2. 悬浮窗权限引导

- [ ] 2.1 实现悬浮窗权限检测（`canDrawOverlays`）与状态展示
- [ ] 2.2 实现跳转系统悬浮窗授权页的引导流程（未授权时不可开启）
- [ ] 2.3 处理用户从设置返回后的权限状态刷新

## 3. 前台服务与悬浮窗容器

- [ ] 3.1 实现前台服务骨架（通知渠道、常驻通知、启动/停止入口）
- [ ] 3.2 实现 `WindowManager` 添加悬浮根视图（`TYPE_APPLICATION_OVERLAY`）并设置基础 flags（可见但不抢焦点）
- [ ] 3.3 实现关闭悬浮面板：移除 View、停止前台服务、移除常驻通知

## 4. 状态模型与本地持久化

- [ ] 4.1 定义对手模型与颜色排除态数据结构（红黄蓝绿 + 默认未排除）
- [ ] 4.2 定义面板配置状态（位置 x/y、透明度、锁定状态、对手列表）
- [ ] 4.3 接入本地持久化（DataStore/Preferences）：保存与恢复完整状态

## 5. 悬浮面板 UI（标记板）

- [ ] 5.1 实现工具条：添加对手、删除对手、重置、锁定/解锁、透明度调节
- [ ] 5.2 实现对手列表渲染：动态人数、默认命名（对手 1/2/...）
- [ ] 5.3 实现颜色按钮样式与交互：点击切换彩色↔灰色（灰色=可能没有该颜色）
- [ ] 5.4 实现“重置”行为：所有对手四种颜色恢复为未排除态且不删除对手

## 6. 拖动定位与锁定防误触

- [ ] 6.1 实现解锁模式拖动：拖动更新悬浮窗位置（限制在工具条拖动以减少误触）
- [ ] 6.2 实现锁定模式：禁止拖动位移（仅按钮可点击）
- [ ] 6.3 验证位置持久化：重启后位置与锁定状态正确恢复

## 7. 验证与收尾

- [ ] 7.1 静态检查 `AndroidManifest.xml` 不包含 `INTERNET` 权限声明
- [ ] 7.2 端到端手测：授权→开启悬浮→标记/增删对手→重启恢复→关闭悬浮
- [ ] 7.3 补充常见机型提示文案（悬浮窗权限/后台限制说明，必要时引导到设置）

